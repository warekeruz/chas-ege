(function () {
    retryWhileError(function () {
        'use strict';
        NAinfo.requireApiVersion(0, 0);

        let illnesses = sklonlxkand([
            'гепатит', 'криворучие', 'соннис', 'забыватикус', 'переленеус', 'шоколадодифицит',
            'антилогизм', 'диабет', 'Ёжико-вирус', 'перфектолиз', 'трудоголизм', 'хладоручие',
            'жмотство', 'физико-зависимость', 'Фентезикоз'
        ]).iz();
        let people = sklonlxkand(['физик', 'химик', 'школьник', 'чудик', 'пациент', 'студент', 'математик']).iz();

        let realRez = sl(30, 95);
        let lozhRez = sl(2, 10);
        let realIll = sl(1, 95);

        let prAnsw1 = (realRez * realIll) / 10000;
        let prAnsw2 = (lozhRez * (100 - realIll)) / 10000;
        let answ = prAnsw1 + prAnsw2;

        let Rez = 'положительным';
        if (sl1()) {
            Rez = 'отрицательным';
            answ = 1 - answ;
        }

        genAssertZ1000(answ);

        let veroyt = ['с вероятностью ', 'в '];
        if (sl1()) realRez /= 100;
        if (sl1()) lozhRez /= 100;
        if (sl1()) realIll /= 100;

        let find = sl1() ? 'вероятность' : 'процент';
        if (find === 'процент') answ *= 100;

        NAtask.setTask({
            text: `Всем ${people.dm} с подозрением на ${illnesses.ve} делают анализ крови. ` +
                `Если анализ выявляет ${illnesses.ve}, то результат анализа называется положительным. ` +
                `У больных ${illnesses.te} ${people.rm} анализ даёт положительный результат ${veroyt[0].esli(realRez < 1)} ${veroyt[1].esli(realRez > 1)} ${realRez.ts()}${`\ %`.esli(realRez > 1)}. ` +
                `Если ${people.im} не болен ${illnesses.te}, то анализ может дать ложный положительный результат ${veroyt[0].esli(lozhRez < 1)} ${veroyt[1].esli(lozhRez > 1)} ${lozhRez.ts()}${`\ %`.esli(lozhRez > 1)}. ` +
                `Известно, что ${realIll.ts()}${`\ %`.esli(realIll > 1)} ${people.rm}, поступающих с подозрением на ${illnesses.ve}, действительно больны ${illnesses.te}. ` +
                `Найдите ${find} того, что результат анализа у ${people.rm}, поступившего в клинику с подозрением на ${illnesses.ve}, будет ${Rez}.`,
            answers: answ,
            analys: `Анализ ${people.rm} может быть положительным по двум причинам:` +
                ` 1) ${people.ie} болеет ${illnesses.te}, его анализ верен; 2) пациент не болеет ${illnesses.te}, его анализ ложен.` +
                ` По формуле условной вероятности: $${realRez.ts()}${` / 100 `.esli(realRez > 1)}\\cdot${realIll.ts()}${` / 100 `.esli(realIll > 1)} = ${prAnsw1.ts()}$` +
                ` и $${lozhRez.ts()}${` / 100 `.esli(lozhRez > 1)}\\cdot(1-${realIll.ts()}${` / 100 `.esli(realIll > 1)}) = ${prAnsw2.ts()}$. ` +
                `События быть больным или быть здоровым образуют полную группу (они несовместны и одно из них непременно наступает),` +
                ` поэтому можно применить формулу полной вероятности. Тогда $${prAnsw1.ts()}+${prAnsw2.ts()}=${(prAnsw1 + prAnsw2).ts()}$. ` +
                `${`Необходимо найти, что анализ будет отрицательным: $1 - ${(prAnsw1 + prAnsw2).ts()}$. `.esli(Rez === 'отрицательным')}` +
                `${`Так как нужно найти процент, умножим полученный ответ на 100: $${(prAnsw1 + prAnsw2).ts()}\\cdot100 = ${answ.ts()}$. `.esli(find === 'процент')}` +
                `Ответ: $${answ.ts()}$`,
        });
    }, 100);
})();
//320207 325761 325763 325765 325767 325769 325771 325773 325775 325777 325779 325781 325783 325785 325787 325789 325791 325793 325795 325797 325799 325801 325803 325805 325807 325809 325811 325813 325815 325817 325819 325821 325823 325825 325827 325829 325831 325833 325835 325837 325839
